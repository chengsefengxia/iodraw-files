{"root":{"data":{"id":"d4ttrfir6fc0","created":1728735984258,"text":"中心主题","expandState":"expand"},"children":[{"data":{"id":"d4ttri13zn40","created":1728735989722,"text":"class WeightedLoss(nn.Module):","layout_mind_offset":{"x":38.00000147521496,"y":-52.999995380640286},"expandState":"expand"},"children":[]},{"data":{"id":"d4ttrxzutj40","created":1728736024474,"text":"class WeightedL1(WeightedLoss):","layout_mind_offset":{"x":46.99999929964531,"y":-10.999999836087227},"expandState":"expand"},"children":[]},{"data":{"id":"d4tts4zr1fs0","created":1728736039705,"text":"class WeightedL2(WeightedLoss):","layout_mind_offset":{"x":53.999999195337296,"y":157.9999976456166},"expandState":"expand"},"children":[]},{"data":{"id":"d4ttsvswsgg0","created":1728736098065,"text":"Losses = {\n\t\"l1\": WeightedL1,\n\t\"l2\": WeightedL2,\n}","layout_mind_offset":{"x":558.9999916702508,"y":182.9999972730875},"expandState":"expand"},"children":[]},{"data":{"id":"d4ttt26un340","created":1728736111969,"text":"def extract(a, t, x_shape):\n\tb, *_ = t.shape  #提取t的batch批次属性  *_   表示忽略其他维度\n\tout = a.gather(-1, t) #使用gather函数从a中沿着最后一个维度提取指定索引 t 的元素\n\treturn out.reshape(b, *((1,) * (len(x_shape) - 1)))\n#既根据索引t 提取a中的特征值","layout_mind_offset":{"x":971.9999855160714,"y":263.0000016540288},"layout":null,"expandState":"expand"},"children":[]},{"data":{"id":"d4tu958g1kg0","created":1728737372422,"text":"模型公式","layout_right_offset":{"x":-496.999994084239,"y":-11.999999821186066}},"children":[]},{"data":{"id":"d4tttieqti80","created":1728736147274,"text":"class SinusoidalPosEmb(nn.Module):","expandState":"expand"},"children":[]},{"data":{"id":"d4tttu09j800","created":1728736172520,"text":"class MLP(nn.Module):","expandState":"expand"},"children":[{"data":{"id":"d4tttuw4a000","created":1728736174446,"text":"def __init__(self, state_dim, action_dim, hidden_dim, device, t_dim=16):","expandState":"expand"},"children":[{"data":{"id":"d4tttuw7o000","created":1728736174452,"text":"super(MLP, self).__init__()","expandState":"expand"},"children":[]}]}]},{"data":{"id":"d4ttu0538hc0","created":1728736185873,"text":"class Diffusion(nn.Module):","expandState":"expand"},"children":[{"data":{"id":"d4ttu0z566g0","created":1728736187690,"text":"def __init__(","expandState":"expand"},"children":[{"data":{"id":"d4ttu0z5h5c0","created":1728736187690,"text":"self,","expandState":"expand"},"children":[]},{"data":{"id":"d4ttu0z560o0","created":1728736187690,"text":"loss_type,    #损失函数类型","expandState":"expand"},"children":[]},{"data":{"id":"d4ttu0z4z4w0","created":1728736187690,"text":"beta_schedule=\"linear\",","expandState":"expand"},"children":[]},{"data":{"id":"d4ttu0z51000","created":1728736187690,"text":"clip_denoised=True,","expandState":"expand"},"children":[]},{"data":{"id":"d4ttu0z58880","created":1728736187690,"text":"predict_epsilon=True,#决定模型是否预测噪声 epsilon，即模型是预测噪声还是原始数据。","expandState":"expand"},"children":[]},{"data":{"id":"d4ttu0z5eao0","created":1728736187690,"text":"**kwargs #如 obs_dim（状态维度）、act_dim（动作维度）、hidden_dim（隐藏层维度）、T（扩散过程的时间步数）、","expandState":"expand"},"children":[{"data":{"id":"d4ttu0z55o80","created":1728736187690,"text":"# device（模型所在的设备，如 CPU 或 GPU）","expandState":"expand"},"children":[]},{"data":{"id":"d4ttu0z53ko0","created":1728736187690,"text":"#obs_dim输入层","expandState":"expand"},"children":[]}]}]},{"data":{"id":"d4ttu0z59m00","created":1728736187690,"text":"):    #额这是参数列表","expandState":"expand"},"children":[]}]}]},"template":"right","theme":"fresh-red","version":"1.4.43"}